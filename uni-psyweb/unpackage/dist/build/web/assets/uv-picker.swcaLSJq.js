var e,t,n,o;import{o as l,c as i,w as a,b as s,n as r,d as c,v as u,B as d,A as m,y as h,k as p,i as f,a as v,e as C,F as y,f as g,am as x,an as _}from"./index-D_t6mnig.js";import{m as I,a as k,r as b,c as $}from"./uv-icon.DNv2e-gP.js";import{_ as S}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as w}from"./uv-popup.CvTR393n.js";const T=S({name:"uv-toolbar",emits:["confirm","cancel"],mixins:[I,k,{props:{show:{type:Boolean,default:!0},showBorder:{type:Boolean,default:!1},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"},title:{type:String,default:""},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.toolbar}}],methods:{cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")}}},[["render",function(e,t,n,o,v,C){const y=p,g=f;return e.show?(l(),i(g,{key:0,class:m(["uv-toolbar",{"uv-border-bottom":e.showBorder}]),onTouchmove:h(e.noop,["stop","prevent"])},{default:a((()=>[s(g,{class:"uv-toolbar__cancel__wrapper","hover-class":"uv-hover-class"},{default:a((()=>[s(y,{class:"uv-toolbar__wrapper__cancel",onClick:C.cancel,style:r({color:e.cancelColor})},{default:a((()=>[c(u(e.cancelText),1)])),_:1},8,["onClick","style"])])),_:1}),e.title?(l(),i(y,{key:0,class:"uv-toolbar__title uv-line-1"},{default:a((()=>[c(u(e.title),1)])),_:1})):d("",!0),s(g,{class:"uv-toolbar__confirm__wrapper","hover-class":"uv-hover-class"},{default:a((()=>[s(y,{class:"uv-toolbar__wrapper__confirm",onClick:C.confirm,style:r({color:e.confirmColor})},{default:a((()=>[c(u(e.confirmText),1)])),_:1},8,["onClick","style"])])),_:1})])),_:1},8,["class","onTouchmove"])):d("",!0)}],["__scopeId","data-v-2f73cab8"]]);const B=S({name:"uv-picker",emits:["confirm","cancel","close","change"],mixins:[I,k,{props:{showToolbar:{type:Boolean,default:!0},title:{type:String,default:""},round:{type:[String,Number],default:0},columns:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},itemHeight:{type:[String,Number],default:44},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确定"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"},color:{type:String,default:""},activeColor:{type:String,default:""},visibleItemCount:{type:[String,Number],default:5},keyName:{type:String,default:"text"},closeOnClickOverlay:{type:Boolean,default:!0},closeOnClickConfirm:{type:Boolean,default:!0},defaultIndex:{type:Array,default:()=>[]},immediateChange:{type:Boolean,default:!0},...null==(o=null==(n=uni.$uv)?void 0:n.props)?void 0:o.picker}}],computed:{textStyle(){return(e,t)=>{const n={display:"block"};return this.color&&(n.color=this.color),this.activeColor&&t===this.innerIndex[e]&&(n.color=this.activeColor),n}}},data:()=>({lastIndex:[],innerIndex:[],innerColumns:[],columnIndex:0}),watch:{defaultIndex:{immediate:!0,handler(e){this.setIndexs(e,!0)}},columns:{deep:!0,immediate:!0,handler(e){this.setColumns(e)}}},methods:{open(){this.$refs.pickerPopup.open()},close(){this.$refs.pickerPopup.close()},popupChange(e){e.show||this.$emit("close")},getItemText(e){return this.$uv.test.object(e)?e[this.keyName]:e},cancel(){this.$emit("cancel"),this.close()},confirm(){this.$emit("confirm",this.$uv.deepClone({indexs:this.innerIndex,value:this.innerColumns.map(((e,t)=>e[this.innerIndex[t]])),values:this.innerColumns})),this.closeOnClickConfirm&&this.close()},changeHandler(e){const{value:t}=e.detail;let n=0,o=0;for(let i=0;i<t.length;i++){let e=t[i];if(e!==(this.lastIndex[i]||0)){o=i,n=e;break}}this.columnIndex=o;const l=this.innerColumns;this.setLastIndex(t),this.setIndexs(t),this.$emit("change",{value:this.innerColumns.map(((e,n)=>e[t[n]])),index:n,indexs:t,values:l,columnIndex:o})},setIndexs(e,t){this.innerIndex=this.$uv.deepClone(e),t&&this.setLastIndex(e)},setLastIndex(e){this.lastIndex=this.$uv.deepClone(e)},setColumnValues(e,t){this.innerColumns.splice(e,1,t);let n=this.$uv.deepClone(this.innerIndex);for(let o=0;o<this.innerColumns.length;o++)o>this.columnIndex&&(n[o]=0);this.setIndexs(n)},getColumnValues(e){return(async()=>{await this.$uv.sleep()})(),this.innerColumns[e]},setColumns(e){this.innerColumns=this.$uv.deepClone(e),0===this.innerIndex.length&&(this.innerIndex=new Array(e.length).fill(0))},getIndexs(){return this.innerIndex},getValues(){return(async()=>{await this.$uv.sleep()})(),this.innerColumns.map(((e,t)=>e[this.innerIndex[t]]))}}},[["render",function(e,t,n,o,m,h){const I=b(v("uv-toolbar"),T),k=p,S=x,B=_,H=b(v("uv-loading-icon"),$),O=f,j=b(v("uv-popup"),w);return l(),i(j,{ref:"pickerPopup",mode:"bottom",round:e.round,"close-on-click-overlay":e.closeOnClickOverlay,onChange:h.popupChange},{default:a((()=>[s(O,{class:"uv-picker"},{default:a((()=>[e.showToolbar?(l(),i(I,{key:0,cancelColor:e.cancelColor,confirmColor:e.confirmColor,cancelText:e.cancelText,confirmText:e.confirmText,title:e.title,onCancel:h.cancel,onConfirm:h.confirm},null,8,["cancelColor","confirmColor","cancelText","confirmText","title","onCancel","onConfirm"])):d("",!0),s(B,{class:"uv-picker__view",indicatorStyle:`height: ${e.$uv.addUnit(e.itemHeight)}`,value:m.innerIndex,immediateChange:e.immediateChange,style:r({height:`${e.$uv.addUnit(e.visibleItemCount*e.itemHeight)}`}),onChange:h.changeHandler},{default:a((()=>[(l(!0),C(y,null,g(m.innerColumns,((t,n)=>(l(),i(S,{key:n,class:"uv-picker__view__column"},{default:a((()=>[e.$uv.test.array(t)?(l(!0),C(y,{key:0},g(t,((t,o)=>(l(),i(k,{class:"uv-picker__view__column__item uv-line-1",key:o,style:r([{height:e.$uv.addUnit(e.itemHeight),lineHeight:e.$uv.addUnit(e.itemHeight),fontWeight:o===m.innerIndex[n]?"bold":"normal"},h.textStyle(n,o)])},{default:a((()=>[c(u(h.getItemText(t)),1)])),_:2},1032,["style"])))),128)):d("",!0)])),_:2},1024)))),128))])),_:1},8,["indicatorStyle","value","immediateChange","style","onChange"]),e.loading?(l(),i(O,{key:1,class:"uv-picker--loading"},{default:a((()=>[s(H,{mode:"circle"})])),_:1})):d("",!0)])),_:1})])),_:1},8,["round","close-on-click-overlay","onChange"])}],["__scopeId","data-v-e71dff16"]]);export{B as _};
